{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://stacktrackr.dev/schemas/lease.json",
  "title": "StackTrackr Memory Lease",
  "description": "Memory access lease for atomic operations",
  "type": "object",
  "required": ["lease_id", "agent_id", "base_hash", "acquired_at", "expires_at", "ttl_sec"],
  "properties": {
    "lease_id": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z_[a-zA-Z0-9_-]+$",
      "description": "Unique lease identifier with timestamp and agent"
    },
    "agent_id": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "description": "ID of the agent holding the lease"
    },
    "base_hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA256 hash of the snapshot when lease was acquired"
    },
    "acquired_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp when lease was acquired"
    },
    "expires_at": {
      "type": "string",
      "format": "date-time", 
      "description": "ISO timestamp when lease expires"
    },
    "ttl_sec": {
      "type": "integer",
      "minimum": 1,
      "maximum": 3600,
      "description": "Time to live in seconds (max 1 hour)"
    },
    "renewed_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of times lease has been renewed"
    },
    "checkout_path": {
      "type": "string",
      "description": "Path to the checked out snapshot"
    }
  },
  "additionalProperties": false
}
