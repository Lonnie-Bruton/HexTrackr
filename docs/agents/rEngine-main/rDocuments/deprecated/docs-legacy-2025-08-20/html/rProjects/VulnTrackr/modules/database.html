<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Module Documentation - StackTrackr Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .header .meta {
            font-size: 0.9em;
            opacity: 0.7;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 8px 16px;
            background: #007acc;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
            max-width: none;
        }

        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .content h1 { font-size: 2.2em; border-bottom: 3px solid #007acc; padding-bottom: 10px; }
        .content h2 { font-size: 1.8em; color: #007acc; }
        .content h3 { font-size: 1.4em; color: #495057; }
        .content h4 { font-size: 1.2em; color: #6c757d; }

        .content p {
            margin-bottom: 16px;
            line-height: 1.7;
            color: #444;
        }

        .content ul, .content ol {
            margin-bottom: 16px;
            padding-left: 25px;
        }

        .content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .content blockquote {
            border-left: 4px solid #007acc;
            background: #f8f9fa;
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 0 6px 6px 0;
        }

        .content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        .content pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .content pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .content th, .content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e1e4e8;
        }

        .content th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .content tr:hover {
            background: #f8f9fa;
        }

        .content a {
            color: #007acc;
            text-decoration: none;
            font-weight: 500;
        }

        .content a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-top: 1px solid #e1e4e8;
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
        }

        .doc-meta {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007acc;
        }

        .doc-meta h3 {
            color: #007acc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }

        .meta-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        .meta-value {
            color: #6c757d;
            font-size: 0.9em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .content { padding: 20px; }
            .header { padding: 20px; }
            .nav-bar { padding: 15px 20px; }
            .nav-links { justify-content: center; }
            .header .meta { flex-direction: column; gap: 10px; }
        }

        /* Category-specific colors */
        .color-vision { --primary: #9c27b0; --secondary: #7b1fa2; }
        .color-roadmap { --primary: #007acc; --secondary: #0056b3; }
        .color-engine { --primary: #2c3e50; --secondary: #34495e; }
        .color-agent { --primary: #28a745; --secondary: #198754; }
        .color-brain { --primary: #6f42c1; --secondary: #495057; }
        .color-docker { --primary: #0db7ed; --secondary: #086dd7; }
        .color-mobile { --primary: #fd7e14; --secondary: #dc3545; }
        .color-protocol { --primary: #20c997; --secondary: #198754; }
        .color-scribe { --primary: #17a2b8; --secondary: #138496; }
        .color-groq { --primary: #ffc107; --secondary: #e0a800; }
        .color-task { --primary: #dc3545; --secondary: #c82333; }
        .color-cleanup { --primary: #6c757d; --secondary: #5a6268; }
        .color-quickstart { --primary: #28a745; --secondary: #198754; }
        .color-patch { --primary: #ff6b35; --secondary: #e55a32; }
        .color-rengine { --primary: #8b5cf6; --secondary: #7c3aed; }
        .color-default { --primary: #495057; --secondary: #6c757d; }
    </style>
</head>
<body class="color-default">
    <div class="container">
        <header class="header">
            <div class="header-icon">üìÑ</div>
            <h1>Database Module Documentation</h1>
            <div class="subtitle">Documentation</div>
            <div class="meta">
                <span>üìÅ database.md</span>
                <span>üìÖ 2025-08-20</span>
                <span>üìä 6KB</span>
            </div>
        </header>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="../index.html" class="nav-link">üè† Documentation Home</a>
                <a href="../developmentstatus.html" class="nav-link">üìä Development Status</a>
                <a href="../rProjects/VulnTrackr/modules/database.md" class="nav-link">üìù View Source MD</a>
                <a href="../json/database.json" class="nav-link">üîß JSON Data</a>
            </div>
        </nav>

        <main class="content">
            <h1 id="database-module-documentation">Database Module Documentation</h1>
<h2 id="purpose--overview">Purpose &amp; Overview</h2>
<p>The <code>database.js</code> script is a module that provides an abstraction layer for managing the data storage of a VPR (Vulnerability Prioritization and Remediation) score tracking application. It supports two storage backends: SQLite for server-side or Electron-based implementations, and local browser storage for client-side web applications.</p>
<p>The module&#39;s main responsibilities are:</p>
<ol>
<li>Initializing the appropriate data storage mechanism based on the provided configuration.</li>
<li>Providing a consistent API for saving, retrieving, and adding VPR scan data.</li>
<li>Handling any necessary error handling or fallback mechanisms.</li>
</ol>
<p>This module aims to decouple the data storage concerns from the core application logic, allowing the application to be more flexible and scalable in its storage options.</p>
<h2 id="technical-architecture">Technical Architecture</h2>
<p>The <code>database.js</code> module exports two main functions:</p>
<ol>
<li><p><code>initDatabase(config)</code>: This function is responsible for setting up the appropriate data storage backend based on the provided configuration. It currently supports two backends:</p>
<ul>
<li><strong>SQLite</strong>: This option is intended for server-side or Electron-based implementations, but is not fully implemented in the provided code. Instead, it falls back to using the local browser storage as a simulation.</li>
<li><strong>Local Storage</strong>: This option is used for client-side web applications, where the data is stored in the browser&#39;s local storage.</li>
</ul>
</li>
<li><p><code>getDockerPersistenceInstructions()</code>: This function returns a string containing instructions for setting up a Docker container with persistent data storage for the VPR Tracker application.</p>
</li>
</ol>
<p>The data flow within the module is as follows:</p>
<ol>
<li>The <code>initDatabase</code> function is called with a configuration object, which specifies the desired storage backend.</li>
<li>Depending on the configuration, the function initializes either the SQLite or local storage backend.</li>
<li>The initialized backend provides a set of methods for interacting with the data storage:<ul>
<li><code>saveHistory(history)</code>: Saves the entire VPR scan history to the storage.</li>
<li><code>getHistory()</code>: Retrieves the entire VPR scan history from the storage.</li>
<li><code>addScan(scan)</code>: Adds a new VPR scan to the history.</li>
<li><code>close()</code>: Closes the connection to the storage backend.</li>
</ul>
</li>
</ol>
<h2 id="dependencies">Dependencies</h2>
<p>The <code>database.js</code> module has no external dependencies. It uses only built-in JavaScript features and APIs, such as <code>localStorage</code> for the local storage implementation.</p>
<h2 id="key-functionsclasses">Key Functions/Classes</h2>
<ol>
<li><p><code>initDatabase(config)</code>:</p>
<ul>
<li><strong>Parameters</strong>: <code>config</code> (object) - Configuration object with a <code>type</code> property that specifies the desired storage backend.</li>
<li><strong>Return Value</strong>: An object with the following methods:<ul>
<li><code>saveHistory(history)</code>: Saves the VPR scan history to the storage.</li>
<li><code>getHistory()</code>: Retrieves the VPR scan history from the storage.</li>
<li><code>addScan(scan)</code>: Adds a new VPR scan to the history.</li>
<li><code>close()</code>: Closes the connection to the storage backend.</li>
</ul>
</li>
</ul>
</li>
<li><p><code>initLocalStorage()</code>:</p>
<ul>
<li><strong>Return Value</strong>: An object with the same methods as the one returned by <code>initDatabase</code>, but using the browser&#39;s local storage as the storage backend.</li>
</ul>
</li>
<li><p><code>initSQLite(config)</code>:</p>
<ul>
<li><strong>Parameters</strong>: <code>config</code> (object) - Configuration object for the SQLite backend.</li>
<li><strong>Return Value</strong>: An object with the same methods as the one returned by <code>initDatabase</code>, but using a simulated SQLite implementation (backed by local storage).</li>
</ul>
</li>
<li><p><code>getDockerPersistenceInstructions()</code>:</p>
<ul>
<li><strong>Return Value</strong>: A string containing instructions for setting up a Docker container with persistent data storage for the VPR Tracker application.</li>
</ul>
</li>
</ol>
<h2 id="usage-examples">Usage Examples</h2>
<pre><code class="language-javascript"><pre><code class="language-javascript">// Initialize the database using the SQLite backend
const config = { type: 'sqlite' };
const db = await initDatabase(config);

// Save VPR scan history
await db.saveHistory([
  { id: 1, score: 85, timestamp: '2023-05-01T12:00:00Z' },
  { id: 2, score: 92, timestamp: '2023-05-02T10:30:00Z' },
]);

// Retrieve VPR scan history
const history = await db.getHistory();
console.log(history);

// Add a new VPR scan
await db.addScan({ id: 3, score: 78, timestamp: '2023-05-03T14:15:00Z' });

// Close the database connection
await db.close();</code></pre>
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>The <code>initDatabase</code> function accepts a configuration object with the following property:</p>
<ul>
<li><code>type</code> (string): Specifies the desired storage backend. Supported values are <code>&#39;sqlite&#39;</code> and <code>&#39;local&#39;</code> (default).</li>
</ul>
<h2 id="error-handling">Error Handling</h2>
<p>The <code>initSQLite</code> function attempts to set up the SQLite backend, but if it encounters any errors, it falls back to using the local storage backend instead. Any errors encountered during the SQLite initialization are logged to the console.</p>
<h2 id="integration">Integration</h2>
<p>The <code>database.js</code> module is designed to be integrated into a larger VPR Tracker application. It provides a consistent API for managing the application&#39;s data storage, allowing the core application logic to be decoupled from the specific storage implementation details.</p>
<h2 id="development-notes">Development Notes</h2>
<ul>
<li>The SQLite backend implementation is a placeholder and does not actually use a real SQLite database. Instead, it simulates the SQLite behavior by using the browser&#39;s local storage.</li>
<li>In a real-world implementation, the SQLite backend would likely use a library like <code>better-sqlite3</code> for server-side or Electron-based applications. For browser-based applications, a solution like IndexedDB would be more appropriate.</li>
<li>The <code>getDockerPersistenceInstructions</code> function provides a template for setting up a Docker container with persistent data storage for the VPR Tracker application. This can be used as a starting point for deploying the application in a containerized environment.</li>
</ul>

        </main>

        <footer class="footer">
            <p>Generated from <strong>database.md</strong> ‚Ä¢ StackTrackr Documentation System ‚Ä¢ Last updated: 2025-08-20</p>
        </footer>
    </div>
</body>
</html>