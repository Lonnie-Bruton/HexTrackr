<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spot Price Management Script - StackTrackr Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .header .meta {
            font-size: 0.9em;
            opacity: 0.7;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 8px 16px;
            background: #007acc;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
            max-width: none;
        }

        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .content h1 { font-size: 2.2em; border-bottom: 3px solid #007acc; padding-bottom: 10px; }
        .content h2 { font-size: 1.8em; color: #007acc; }
        .content h3 { font-size: 1.4em; color: #495057; }
        .content h4 { font-size: 1.2em; color: #6c757d; }

        .content p {
            margin-bottom: 16px;
            line-height: 1.7;
            color: #444;
        }

        .content ul, .content ol {
            margin-bottom: 16px;
            padding-left: 25px;
        }

        .content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .content blockquote {
            border-left: 4px solid #007acc;
            background: #f8f9fa;
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 0 6px 6px 0;
        }

        .content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        .content pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .content pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .content th, .content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e1e4e8;
        }

        .content th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .content tr:hover {
            background: #f8f9fa;
        }

        .content a {
            color: #007acc;
            text-decoration: none;
            font-weight: 500;
        }

        .content a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-top: 1px solid #e1e4e8;
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
        }

        .doc-meta {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007acc;
        }

        .doc-meta h3 {
            color: #007acc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }

        .meta-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        .meta-value {
            color: #6c757d;
            font-size: 0.9em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .content { padding: 20px; }
            .header { padding: 20px; }
            .nav-bar { padding: 15px 20px; }
            .nav-links { justify-content: center; }
            .header .meta { flex-direction: column; gap: 10px; }
        }

        /* Category-specific colors */
        .color-vision { --primary: #9c27b0; --secondary: #7b1fa2; }
        .color-roadmap { --primary: #007acc; --secondary: #0056b3; }
        .color-engine { --primary: #2c3e50; --secondary: #34495e; }
        .color-agent { --primary: #28a745; --secondary: #198754; }
        .color-brain { --primary: #6f42c1; --secondary: #495057; }
        .color-docker { --primary: #0db7ed; --secondary: #086dd7; }
        .color-mobile { --primary: #fd7e14; --secondary: #dc3545; }
        .color-protocol { --primary: #20c997; --secondary: #198754; }
        .color-scribe { --primary: #17a2b8; --secondary: #138496; }
        .color-groq { --primary: #ffc107; --secondary: #e0a800; }
        .color-task { --primary: #dc3545; --secondary: #c82333; }
        .color-cleanup { --primary: #6c757d; --secondary: #5a6268; }
        .color-quickstart { --primary: #28a745; --secondary: #198754; }
        .color-patch { --primary: #ff6b35; --secondary: #e55a32; }
        .color-rengine { --primary: #8b5cf6; --secondary: #7c3aed; }
        .color-default { --primary: #495057; --secondary: #6c757d; }
    </style>
</head>
<body class="color-default">
    <div class="container">
        <header class="header">
            <div class="header-icon">üìÑ</div>
            <h1>Spot Price Management Script</h1>
            <div class="subtitle">Documentation</div>
            <div class="meta">
                <span>üìÅ spot.md</span>
                <span>üìÖ 2025-08-20</span>
                <span>üìä 9KB</span>
            </div>
        </header>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="../index.html" class="nav-link">üè† Documentation Home</a>
                <a href="../developmentstatus.html" class="nav-link">üìä Development Status</a>
                <a href="../rProjects/StackTrackr/js/spot.md" class="nav-link">üìù View Source MD</a>
                <a href="../json/spot.json" class="nav-link">üîß JSON Data</a>
            </div>
        </nav>

        <main class="content">
            <h1 id="spot-price-management-script">Spot Price Management Script</h1>
<h2 id="purpose--overview">Purpose &amp; Overview</h2>
<p>The <code>spot.js</code> script is responsible for managing the spot prices of various precious metals, including Silver, Gold, Platinum, and Palladium. It provides functionality to load, save, and update spot prices, as well as maintain a history of price changes. This script is a critical component of the larger application, as it ensures accurate and up-to-date spot price information is available for various user-facing features and calculations.</p>
<h2 id="technical-architecture">Technical Architecture</h2>
<p>The <code>spot.js</code> script is structured around several key functions and data structures:</p>
<ol>
<li><p><strong>Spot Price History Management</strong>:</p>
<ul>
<li><code>saveSpotHistory()</code>: Saves the current spot price history to the browser&#39;s local storage.</li>
<li><code>loadSpotHistory()</code>: Loads the spot price history from local storage.</li>
<li><code>purgeSpotHistory(days)</code>: Removes spot price history entries older than the specified number of days.</li>
<li><code>recordSpot(newSpot, source, metal, provider, timestamp)</code>: Adds a new spot price entry to the history.</li>
</ul>
</li>
<li><p><strong>Timestamp Management</strong>:</p>
<ul>
<li><code>updateLastTimestamps(source, provider, timestamp)</code>: Stores the last cache refresh and API sync timestamps.</li>
</ul>
</li>
<li><p><strong>Spot Price Display</strong>:</p>
<ul>
<li><code>updateSpotCardColor(metalKey, newPrice)</code>: Updates the spot price display element&#39;s color based on the price movement compared to the last history entry.</li>
<li><code>fetchSpotPrice()</code>: Loads the current spot prices from local storage or defaults, and updates the display.</li>
</ul>
</li>
<li><p><strong>Manual Spot Price Update</strong>:</p>
<ul>
<li><code>updateManualSpot(metalKey)</code>: Updates the spot price for a specific metal based on user input.</li>
<li><code>resetSpot(metalKey)</code>: Resets the spot price for a specific metal to the default or cached API value.</li>
<li><code>resetSpotByName(metalName)</code>: Alternative reset function that works with the metal name instead of the key.</li>
</ul>
</li>
</ol>
<p>The script relies on several global variables and objects, such as <code>spotHistory</code>, <code>spotPrices</code>, <code>elements</code>, <code>METALS</code>, <code>API_PROVIDERS</code>, and <code>formatCurrency</code> (if available).</p>
<h2 id="dependencies">Dependencies</h2>
<p>The <code>spot.js</code> script does not have any direct imports or external dependencies. However, it relies on the following external functions and data structures:</p>
<ul>
<li><code>saveDataSync(key, data)</code>: A function to save data synchronously to the browser&#39;s local storage.</li>
<li><code>loadDataSync(key, defaultValue)</code>: A function to load data synchronously from the browser&#39;s local storage.</li>
<li><code>saveData(key, data)</code>: A function to save data asynchronously to the browser&#39;s local storage.</li>
<li><code>elements</code>: An object containing references to various HTML elements used for spot price display and input.</li>
<li><code>METALS</code>: An object containing configuration details for the supported metals (Silver, Gold, Platinum, Palladium).</li>
<li><code>API_PROVIDERS</code>: An object containing details about the available API providers.</li>
<li><code>formatCurrency(value)</code>: A function to format a currency value (if available).</li>
<li><code>apiCache</code>: An object containing the cached API data (if available).</li>
<li><code>hideManualInput(metalName)</code>: A function to hide the manual input section for a specific metal (if available).</li>
</ul>
<h2 id="key-functionsclasses">Key Functions/Classes</h2>
<ol>
<li><p><strong>Spot Price History Management</strong>:</p>
<ul>
<li><code>saveSpotHistory()</code>: Saves the current spot price history to the browser&#39;s local storage.</li>
<li><code>loadSpotHistory()</code>: Loads the spot price history from local storage.</li>
<li><code>purgeSpotHistory(days)</code>: Removes spot price history entries older than the specified number of days.</li>
<li><code>recordSpot(newSpot, source, metal, provider, timestamp)</code>: Adds a new spot price entry to the history.</li>
</ul>
</li>
<li><p><strong>Timestamp Management</strong>:</p>
<ul>
<li><code>updateLastTimestamps(source, provider, timestamp)</code>: Stores the last cache refresh and API sync timestamps.</li>
</ul>
</li>
<li><p><strong>Spot Price Display</strong>:</p>
<ul>
<li><code>updateSpotCardColor(metalKey, newPrice)</code>: Updates the spot price display element&#39;s color based on the price movement compared to the last history entry.</li>
<li><code>fetchSpotPrice()</code>: Loads the current spot prices from local storage or defaults, and updates the display.</li>
</ul>
</li>
<li><p><strong>Manual Spot Price Update</strong>:</p>
<ul>
<li><code>updateManualSpot(metalKey)</code>: Updates the spot price for a specific metal based on user input.</li>
<li><code>resetSpot(metalKey)</code>: Resets the spot price for a specific metal to the default or cached API value.</li>
<li><code>resetSpotByName(metalName)</code>: Alternative reset function that works with the metal name instead of the key.</li>
</ul>
</li>
</ol>
<h2 id="usage-examples">Usage Examples</h2>
<ol>
<li><p><strong>Fetching Spot Prices</strong>:</p>
<pre><code class="language-javascript"><pre><code class="language-javascript">fetchSpotPrice();</code></pre>
</code></pre>
<p>This function loads the current spot prices from local storage or defaults, and updates the display.</p>
</li>
<li><p><strong>Updating Spot Price Manually</strong>:</p>
<pre><code class="language-javascript"><pre><code class="language-javascript">updateManualSpot('silver');</code></pre>
</code></pre>
<p>This function updates the spot price for the &quot;Silver&quot; metal based on user input.</p>
</li>
<li><p><strong>Resetting Spot Price</strong>:</p>
<pre><code class="language-javascript"><pre><code class="language-javascript">resetSpot('gold');</code></pre>
</code></pre>
<p>This function resets the spot price for the &quot;Gold&quot; metal to the default or cached API value.</p>
</li>
<li><p><strong>Resetting Spot Price by Name</strong>:</p>
<pre><code class="language-javascript"><pre><code class="language-javascript">resetSpotByName('Platinum');</code></pre>
</code></pre>
<p>This function resets the spot price for the &quot;Platinum&quot; metal to the default or cached API value.</p>
</li>
</ol>
<h2 id="configuration">Configuration</h2>
<p>The <code>spot.js</code> script does not have any explicit configuration options or environment variables. However, it relies on the following global variables and objects:</p>
<ul>
<li><code>SPOT_HISTORY_KEY</code>: The key used to store the spot price history in local storage.</li>
<li><code>LAST_API_SYNC_KEY</code>: The key used to store the last API sync timestamp in local storage.</li>
<li><code>LAST_CACHE_REFRESH_KEY</code>: The key used to store the last cache refresh timestamp in local storage.</li>
<li><code>METALS</code>: An object containing configuration details for the supported metals.</li>
<li><code>API_PROVIDERS</code>: An object containing details about the available API providers.</li>
</ul>
<h2 id="error-handling">Error Handling</h2>
<p>The <code>spot.js</code> script handles errors in the following ways:</p>
<ol>
<li><p><strong>Saving/Loading Spot History</strong>:</p>
<ul>
<li>If an error occurs while saving the spot history to local storage, it logs the error to the console.</li>
<li>If an error occurs while loading the spot history from local storage, it logs the error to the console and initializes an empty spot history.</li>
</ul>
</li>
<li><p><strong>Updating Timestamps</strong>:</p>
<ul>
<li>The <code>updateLastTimestamps</code> function handles errors gracefully without causing any issues.</li>
</ul>
</li>
<li><p><strong>Manual Spot Price Update</strong>:</p>
<ul>
<li>If the user enters an invalid spot price, the script displays an alert with an error message.</li>
</ul>
</li>
</ol>
<h2 id="integration">Integration</h2>
<p>The <code>spot.js</code> script is a critical component of the larger application, as it provides accurate and up-to-date spot price information for various user-facing features and calculations. It integrates with the following components:</p>
<ol>
<li><strong>API Integration</strong>: The script can integrate with external APIs to fetch the latest spot prices, which are then cached and used to update the local spot price history and display.</li>
<li><strong>User Interface</strong>: The script updates the spot price display elements and provides functionality for manual spot price updates.</li>
<li><strong>Calculations</strong>: The spot price data maintained by this script is used in various calculations and financial analyses throughout the application.</li>
</ol>
<h2 id="development-notes">Development Notes</h2>
<ol>
<li><p><strong>Spot Price History Management</strong>:</p>
<ul>
<li>The script uses a simple array-based approach to store the spot price history, which may not be suitable for large volumes of data. Consider using a more efficient data structure or a database-backed solution for larger-scale applications.</li>
<li>The <code>purgeSpotHistory</code> function assumes a fixed number of days to retain history. This may need to be configurable or based on more complex rules in some applications.</li>
</ul>
</li>
<li><p><strong>Timestamp Management</strong>:</p>
<ul>
<li>The script stores the last cache refresh and API sync timestamps separately. This may need to be consolidated or expanded depending on the application&#39;s requirements.</li>
</ul>
</li>
<li><p><strong>Manual Spot Price Update</strong>:</p>
<ul>
<li>The script provides a simple interface for manual spot price updates, but it does not include any validation or input formatting. This may need to be enhanced in a production-ready application.</li>
</ul>
</li>
<li><p><strong>Extensibility</strong>:</p>
<ul>
<li>The script is designed to be extensible, with the ability to add support for new metals or API providers. However, this may require updates to the underlying data structures and configuration objects.</li>
</ul>
</li>
<li><p><strong>Performance</strong>:</p>
<ul>
<li>The script&#39;s performance may be affected by the size of the spot price history or the frequency of updates. Consider optimizing the history management and display update logic for larger-scale applications.</li>
</ul>
</li>
<li><p><strong>Dependency Management</strong>:</p>
<ul>
<li>The script relies on several external functions and data structures, which may need to be better encapsulated or injected as dependencies for improved testability and maintainability.</li>
</ul>
</li>
</ol>
<p>Overall, the <code>spot.js</code> script provides a solid foundation for managing spot prices in a web application, but may require additional refinement and enhancement to meet the specific requirements of a production-ready system.</p>

        </main>

        <footer class="footer">
            <p>Generated from <strong>spot.md</strong> ‚Ä¢ StackTrackr Documentation System ‚Ä¢ Last updated: 2025-08-20</p>
        </footer>
    </div>
</body>
</html>