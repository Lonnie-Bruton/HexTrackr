<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Fallback Handler for StackTrackr - StackTrackr Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .header .meta {
            font-size: 0.9em;
            opacity: 0.7;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 8px 16px;
            background: #007acc;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
            max-width: none;
        }

        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .content h1 { font-size: 2.2em; border-bottom: 3px solid #007acc; padding-bottom: 10px; }
        .content h2 { font-size: 1.8em; color: #007acc; }
        .content h3 { font-size: 1.4em; color: #495057; }
        .content h4 { font-size: 1.2em; color: #6c757d; }

        .content p {
            margin-bottom: 16px;
            line-height: 1.7;
            color: #444;
        }

        .content ul, .content ol {
            margin-bottom: 16px;
            padding-left: 25px;
        }

        .content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .content blockquote {
            border-left: 4px solid #007acc;
            background: #f8f9fa;
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 0 6px 6px 0;
        }

        .content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        .content pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .content pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .content th, .content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e1e4e8;
        }

        .content th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .content tr:hover {
            background: #f8f9fa;
        }

        .content a {
            color: #007acc;
            text-decoration: none;
            font-weight: 500;
        }

        .content a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-top: 1px solid #e1e4e8;
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
        }

        .doc-meta {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007acc;
        }

        .doc-meta h3 {
            color: #007acc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }

        .meta-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        .meta-value {
            color: #6c757d;
            font-size: 0.9em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .content { padding: 20px; }
            .header { padding: 20px; }
            .nav-bar { padding: 15px 20px; }
            .nav-links { justify-content: center; }
            .header .meta { flex-direction: column; gap: 10px; }
        }

        /* Category-specific colors */
        .color-vision { --primary: #9c27b0; --secondary: #7b1fa2; }
        .color-roadmap { --primary: #007acc; --secondary: #0056b3; }
        .color-engine { --primary: #2c3e50; --secondary: #34495e; }
        .color-agent { --primary: #28a745; --secondary: #198754; }
        .color-brain { --primary: #6f42c1; --secondary: #495057; }
        .color-docker { --primary: #0db7ed; --secondary: #086dd7; }
        .color-mobile { --primary: #fd7e14; --secondary: #dc3545; }
        .color-protocol { --primary: #20c997; --secondary: #198754; }
        .color-scribe { --primary: #17a2b8; --secondary: #138496; }
        .color-groq { --primary: #ffc107; --secondary: #e0a800; }
        .color-task { --primary: #dc3545; --secondary: #c82333; }
        .color-cleanup { --primary: #6c757d; --secondary: #5a6268; }
        .color-quickstart { --primary: #28a745; --secondary: #198754; }
        .color-patch { --primary: #ff6b35; --secondary: #e55a32; }
        .color-rengine { --primary: #8b5cf6; --secondary: #7c3aed; }
        .color-default { --primary: #495057; --secondary: #6c757d; }
    </style>
</head>
<body class="color-default">
    <div class="container">
        <header class="header">
            <div class="header-icon">üìÑ</div>
            <h1>MCP Fallback Handler for StackTrackr</h1>
            <div class="subtitle">Documentation</div>
            <div class="meta">
                <span>üìÅ mcp-fallback-handler.md</span>
                <span>üìÖ 2025-08-20</span>
                <span>üìä 6KB</span>
            </div>
        </header>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="../index.html" class="nav-link">üè† Documentation Home</a>
                <a href="../developmentstatus.html" class="nav-link">üìä Development Status</a>
                <a href="../generated/mcp-fallback-handler.md" class="nav-link">üìù View Source MD</a>
                <a href="../json/mcp-fallback-handler.json" class="nav-link">üîß JSON Data</a>
            </div>
        </nav>

        <main class="content">
            <h1 id="mcp-fallback-handler-for-stacktrackr">MCP Fallback Handler for StackTrackr</h1>
<h2 id="purpose--overview">Purpose &amp; Overview</h2>
<p>The <code>mcp-fallback-handler.js</code> script provides an automatic fallback mechanism to local JSON memory files when the MCP (Memory Coordination Platform) server is unavailable or fails. This ensures that the application can continue to function and retrieve memory data even when the primary MCP server is inaccessible.</p>
<p>The script is designed to be used as a dependency in the StackTrackr application, allowing it to seamlessly switch between the MCP server and local JSON files for memory retrieval, ensuring a robust and reliable user experience.</p>
<h2 id="technical-architecture">Technical Architecture</h2>
<p>The <code>MCPFallbackHandler</code> class is the main component of this script and provides the following key functionality:</p>
<ol>
<li><strong>MCP Connection Testing</strong>: The <code>testMCPConnection()</code> method checks if the MCP server is available and running.</li>
<li><strong>Local Memory Fallback</strong>: The <code>getLocalMemory()</code> method retrieves memory data from local JSON files when the MCP server is unavailable.</li>
<li><strong>Memory File Retrieval</strong>: The <code>getMemoryFile()</code> method retrieves a specific JSON memory file from predefined locations.</li>
<li><strong>Handoff Information</strong>: The <code>getHandoffInfo()</code> method retrieves critical handoff information, which is essential for agent transitions.</li>
<li><strong>Memory Retrieval with Fallback</strong>: The <code>getMemoryWithFallback()</code> method is the main entry point, which first checks the MCP server availability and then falls back to the local JSON files if necessary.</li>
<li><strong>Emergency Handoff</strong>: The <code>emergencyHandoff()</code> method retrieves all critical files for emergency handoff, regardless of the MCP server status.</li>
</ol>
<p>The script also includes a CLI interface that allows users to interact with the various functionalities of the <code>MCPFallbackHandler</code> class.</p>
<h2 id="dependencies">Dependencies</h2>
<p>This script imports the following external dependencies:</p>
<ul>
<li><code>fs/promises</code>: For file system operations.</li>
<li><code>path</code>: For handling file paths.</li>
<li><code>child_process</code>: For executing external commands.</li>
<li><code>url</code>: For converting file URLs to file paths.</li>
</ul>
<h2 id="key-functionsclasses">Key Functions/Classes</h2>
<h3 id="mcpfallbackhandler-class"><code>MCPFallbackHandler</code> Class</h3>
<h4 id="testmcpconnection"><code>testMCPConnection()</code></h4>
<ul>
<li><strong>Purpose</strong>: Checks if the MCP server is available and running.</li>
<li><strong>Parameters</strong>: None.</li>
<li><strong>Return Value</strong>: <code>true</code> if the MCP server is available, <code>false</code> otherwise.</li>
</ul>
<h4 id="getlocalmemorysearchterm"><code>getLocalMemory(searchTerm)</code></h4>
<ul>
<li><strong>Purpose</strong>: Retrieves memory data from local JSON files using the existing <code>recall.js</code> system.</li>
<li><strong>Parameters</strong>: <code>searchTerm</code> (optional) - The search term for the memory retrieval.</li>
<li><strong>Return Value</strong>: An object containing the source, success status, data (or error message), and the search term.</li>
</ul>
<h4 id="getmemoryfilefilename"><code>getMemoryFile(filename)</code></h4>
<ul>
<li><strong>Purpose</strong>: Retrieves a specific JSON memory file from predefined locations.</li>
<li><strong>Parameters</strong>: <code>filename</code> - The name of the memory file to retrieve.</li>
<li><strong>Return Value</strong>: An object containing the source, success status, file path, and the data (or error message).</li>
</ul>
<h4 id="gethandoffinfo"><code>getHandoffInfo()</code></h4>
<ul>
<li><strong>Purpose</strong>: Retrieves the handoff information, which is critical for agent transitions.</li>
<li><strong>Parameters</strong>: None.</li>
<li><strong>Return Value</strong>: An object containing the source, success status, file path, data, and a summary of the current handoff.</li>
</ul>
<h4 id="getmemorywithfallbacksearchterm"><code>getMemoryWithFallback(searchTerm)</code></h4>
<ul>
<li><strong>Purpose</strong>: Retrieves memory data, first checking the MCP server availability and then falling back to local JSON files if necessary.</li>
<li><strong>Parameters</strong>: <code>searchTerm</code> (optional) - The search term for the memory retrieval.</li>
<li><strong>Return Value</strong>: An object containing the source, success status, data (or error message), and the search term.</li>
</ul>
<h4 id="emergencyhandoff"><code>emergencyHandoff()</code></h4>
<ul>
<li><strong>Purpose</strong>: Retrieves all critical files for emergency handoff, regardless of the MCP server status.</li>
<li><strong>Parameters</strong>: None.</li>
<li><strong>Return Value</strong>: An object containing the source, success status, and the retrieved critical data.</li>
</ul>
<h2 id="usage-examples">Usage Examples</h2>
<ol>
<li><strong>Retrieving Memory with Fallback</strong>:</li>
</ol>
<pre><code class="language-javascript"><pre><code class="language-javascript">const fallback = require('./mcp-fallback-handler.js');
const memory = await fallback.getMemoryWithFallback('search term');
console.log(memory);</code></pre>
</code></pre>
<ol start="2">
<li><strong>Retrieving Handoff Information</strong>:</li>
</ol>
<pre><code class="language-javascript"><pre><code class="language-javascript">const fallback = require('./mcp-fallback-handler.js');
const handoff = await fallback.getHandoffInfo();
console.log(handoff);</code></pre>
</code></pre>
<ol start="3">
<li><strong>Performing Emergency Handoff</strong>:</li>
</ol>
<pre><code class="language-javascript"><pre><code class="language-javascript">const fallback = require('./mcp-fallback-handler.js');
const emergency = await fallback.emergencyHandoff();
console.log(emergency);</code></pre>
</code></pre>
<ol start="4">
<li><strong>Testing MCP Server Availability</strong>:</li>
</ol>
<pre><code class="language-javascript"><pre><code class="language-javascript">const fallback = require('./mcp-fallback-handler.js');
const available = await fallback.testMCPConnection();
console.log(`MCP Server is ${available ? 'available' : 'unavailable'}`);</code></pre>
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>This script does not require any external configuration. The necessary paths and file locations are hardcoded within the <code>MCPFallbackHandler</code> class.</p>
<h2 id="error-handling">Error Handling</h2>
<p>The script handles errors in the following ways:</p>
<ol>
<li><strong>MCP Connection Testing</strong>: If the MCP server is not detected, the <code>testMCPConnection()</code> method returns <code>false</code> and logs a message indicating the fallback to local JSON memory.</li>
<li><strong>Local Memory Retrieval</strong>: If the local memory retrieval fails, the <code>getLocalMemory()</code> method returns an object with the <code>success</code> property set to <code>false</code> and the error message.</li>
<li><strong>Memory File Retrieval</strong>: If the memory file is not found in any of the predefined locations, the <code>getMemoryFile()</code> method returns an object with the <code>success</code> property set to <code>false</code> and an error message.</li>
<li><strong>Handoff Information Retrieval</strong>: If the handoff information is not found, the <code>getHandoffInfo()</code> method returns an object with the <code>success</code> property set to <code>false</code> and an error message.</li>
</ol>
<h2 id="integration">Integration</h2>
<p>This <code>mcp-fallback-handler.js</code> script is designed to be used as a dependency within the StackTrackr application. It provides a seamless fallback mechanism for memory retrieval, ensuring that the application can continue to function even when the primary MCP server is unavailable.</p>
<h2 id="development-notes">Development Notes</h2>
<ul>
<li>The script uses the existing <code>recall.js</code> system for local memory retrieval, which is a part of the StackTrackr application.</li>
<li>The hardcoded file paths and locations may need to be adjusted based on the specific project structure and deployment environment.</li>
<li>The script assumes the existence of certain critical JSON files (e.g., <code>handoff.json</code>, <code>tasks.json</code>, etc.) in the predefined locations.</li>
<li>The emergency handoff functionality is designed to provide a last-resort option for retrieving critical data, regardless of the MCP server status.</li>
</ul>

        </main>

        <footer class="footer">
            <p>Generated from <strong>mcp-fallback-handler.md</strong> ‚Ä¢ StackTrackr Documentation System ‚Ä¢ Last updated: 2025-08-20</p>
        </footer>
    </div>
</body>
</html>