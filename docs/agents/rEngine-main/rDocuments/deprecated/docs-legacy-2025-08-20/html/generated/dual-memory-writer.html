<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dual Memory Writer - StackTrackr Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .header .meta {
            font-size: 0.9em;
            opacity: 0.7;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 8px 16px;
            background: #007acc;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
            max-width: none;
        }

        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .content h1 { font-size: 2.2em; border-bottom: 3px solid #007acc; padding-bottom: 10px; }
        .content h2 { font-size: 1.8em; color: #007acc; }
        .content h3 { font-size: 1.4em; color: #495057; }
        .content h4 { font-size: 1.2em; color: #6c757d; }

        .content p {
            margin-bottom: 16px;
            line-height: 1.7;
            color: #444;
        }

        .content ul, .content ol {
            margin-bottom: 16px;
            padding-left: 25px;
        }

        .content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .content blockquote {
            border-left: 4px solid #007acc;
            background: #f8f9fa;
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 0 6px 6px 0;
        }

        .content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        .content pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .content pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .content th, .content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e1e4e8;
        }

        .content th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .content tr:hover {
            background: #f8f9fa;
        }

        .content a {
            color: #007acc;
            text-decoration: none;
            font-weight: 500;
        }

        .content a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-top: 1px solid #e1e4e8;
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
        }

        .doc-meta {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007acc;
        }

        .doc-meta h3 {
            color: #007acc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }

        .meta-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        .meta-value {
            color: #6c757d;
            font-size: 0.9em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .content { padding: 20px; }
            .header { padding: 20px; }
            .nav-bar { padding: 15px 20px; }
            .nav-links { justify-content: center; }
            .header .meta { flex-direction: column; gap: 10px; }
        }

        /* Category-specific colors */
        .color-vision { --primary: #9c27b0; --secondary: #7b1fa2; }
        .color-roadmap { --primary: #007acc; --secondary: #0056b3; }
        .color-engine { --primary: #2c3e50; --secondary: #34495e; }
        .color-agent { --primary: #28a745; --secondary: #198754; }
        .color-brain { --primary: #6f42c1; --secondary: #495057; }
        .color-docker { --primary: #0db7ed; --secondary: #086dd7; }
        .color-mobile { --primary: #fd7e14; --secondary: #dc3545; }
        .color-protocol { --primary: #20c997; --secondary: #198754; }
        .color-scribe { --primary: #17a2b8; --secondary: #138496; }
        .color-groq { --primary: #ffc107; --secondary: #e0a800; }
        .color-task { --primary: #dc3545; --secondary: #c82333; }
        .color-cleanup { --primary: #6c757d; --secondary: #5a6268; }
        .color-quickstart { --primary: #28a745; --secondary: #198754; }
        .color-patch { --primary: #ff6b35; --secondary: #e55a32; }
        .color-rengine { --primary: #8b5cf6; --secondary: #7c3aed; }
        .color-default { --primary: #495057; --secondary: #6c757d; }
    </style>
</head>
<body class="color-default">
    <div class="container">
        <header class="header">
            <div class="header-icon">üìÑ</div>
            <h1>Dual Memory Writer</h1>
            <div class="subtitle">Documentation</div>
            <div class="meta">
                <span>üìÅ dual-memory-writer.md</span>
                <span>üìÖ 2025-08-20</span>
                <span>üìä 6KB</span>
            </div>
        </header>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="../index.html" class="nav-link">üè† Documentation Home</a>
                <a href="../developmentstatus.html" class="nav-link">üìä Development Status</a>
                <a href="../generated/dual-memory-writer.md" class="nav-link">üìù View Source MD</a>
                <a href="../json/dual-memory-writer.json" class="nav-link">üîß JSON Data</a>
            </div>
        </nav>

        <main class="content">
            <h1 id="dual-memory-writer">Dual Memory Writer</h1>
<h2 id="purpose--overview">Purpose &amp; Overview</h2>
<p>The <code>dual-memory-writer.js</code> script is a utility that ensures all agents write their memory data to both a persistent memory store (<code>persistent-memory.json</code>) and an agent-specific memory file (<code>agent-type-memory.json</code>). It also writes a summary of the memory write operation to an extended context file (<code>extendedcontext.json</code>). This redundancy helps maintain data integrity and ensures that agent memory is consistently available across different parts of the system.</p>
<p>The script includes JSON data sanitization and error handling to provide a robust and reliable memory writing solution.</p>
<h2 id="technical-architecture">Technical Architecture</h2>
<p>The <code>DualMemoryWriter</code> class is the main component of this script. It has the following key properties and methods:</p>
<p><strong>Properties</strong>:</p>
<ul>
<li><code>baseDir</code>: The base directory of the project.</li>
<li><code>persistentMemoryPath</code>: The file path for the persistent memory store.</li>
<li><code>agentMemoryDir</code>: The directory where agent-specific memory files are stored.</li>
<li><code>extendedContextPath</code>: The file path for the extended context file.</li>
</ul>
<p><strong>Methods</strong>:</p>
<ul>
<li><code>sanitizeForJSON(data)</code>: Sanitizes the input data to prevent JSON parsing errors.</li>
<li><code>writeToPersistentMemory(entry)</code>: Writes the provided memory entry to the persistent memory store.</li>
<li><code>writeToAgentMemory(agentType, entry)</code>: Writes the provided memory entry to the agent-specific memory file.</li>
<li><code>writeToExtendedContext(entry)</code>: Writes a summary of the memory write operation to the extended context file.</li>
<li><code>dualWrite(agentType, entry)</code>: Orchestrates the dual writing process by calling the above methods in parallel.</li>
</ul>
<p>The data flow in this script is as follows:</p>
<ol>
<li>The <code>dualWrite</code> method is called with an <code>agentType</code> and a memory <code>entry</code> object.</li>
<li>The method calls <code>writeToPersistentMemory</code>, <code>writeToAgentMemory</code>, and <code>writeToExtendedContext</code> in parallel.</li>
<li>Each of these methods reads the corresponding file, updates it with the provided data, and writes the file back.</li>
<li>The <code>dualWrite</code> method returns a boolean indicating the overall success of the dual write operation.</li>
</ol>
<h2 id="dependencies">Dependencies</h2>
<p>This script imports the following dependencies:</p>
<ul>
<li><code>fs/promises</code>: The file system module, used for reading and writing files.</li>
<li><code>path</code>: The path module, used for managing file paths.</li>
<li><code>fileURLToPath</code>: A utility function from the <code>url</code> module, used to convert a file URL to a file path.</li>
</ul>
<h2 id="key-functionsclasses">Key Functions/Classes</h2>
<h3 id="dualmemorywriter-class"><code>DualMemoryWriter</code> Class</h3>
<p>The <code>DualMemoryWriter</code> class is the main component of this script. It has the following key methods:</p>
<h4 id="sanitizeforjsondata"><code>sanitizeForJSON(data)</code></h4>
<ul>
<li><strong>Purpose</strong>: Sanitizes the input data to prevent JSON parsing errors.</li>
<li><strong>Parameters</strong>: <code>data</code> (any): The data to be sanitized.</li>
<li><strong>Return Value</strong>: The sanitized data.</li>
</ul>
<h4 id="writetopersistentmemoryentry"><code>writeToPersistentMemory(entry)</code></h4>
<ul>
<li><strong>Purpose</strong>: Writes the provided memory entry to the persistent memory store.</li>
<li><strong>Parameters</strong>: <code>entry</code> (object): The memory entry to be written.</li>
<li><strong>Return Value</strong>: <code>true</code> if the write operation was successful, <code>false</code> otherwise.</li>
</ul>
<h4 id="writetoagentmemoryagenttype-entry"><code>writeToAgentMemory(agentType, entry)</code></h4>
<ul>
<li><strong>Purpose</strong>: Writes the provided memory entry to the agent-specific memory file.</li>
<li><strong>Parameters</strong>: <code>agentType</code> (string): The type of the agent, <code>entry</code> (object): The memory entry to be written.</li>
<li><strong>Return Value</strong>: <code>true</code> if the write operation was successful, <code>false</code> otherwise.</li>
</ul>
<h4 id="writetoextendedcontextentry"><code>writeToExtendedContext(entry)</code></h4>
<ul>
<li><strong>Purpose</strong>: Writes a summary of the memory write operation to the extended context file.</li>
<li><strong>Parameters</strong>: <code>entry</code> (object): The memory entry to be written.</li>
<li><strong>Return Value</strong>: <code>true</code> if the write operation was successful, <code>false</code> otherwise.</li>
</ul>
<h4 id="dualwriteagenttype-entry"><code>dualWrite(agentType, entry)</code></h4>
<ul>
<li><strong>Purpose</strong>: Orchestrates the dual writing process by calling the above methods in parallel.</li>
<li><strong>Parameters</strong>: <code>agentType</code> (string): The type of the agent, <code>entry</code> (object): The memory entry to be written.</li>
<li><strong>Return Value</strong>: <code>true</code> if at least 2 out of 3 write operations were successful, <code>false</code> otherwise.</li>
</ul>
<h2 id="usage-examples">Usage Examples</h2>
<p>To use the <code>DualMemoryWriter</code> class, you can create an instance and call the <code>dualWrite</code> method:</p>
<pre><code class="language-javascript"><pre><code class="language-javascript">import DualMemoryWriter from './dual-memory-writer.js';

const writer = new DualMemoryWriter();
const agentType = 'claude';
const title = 'Test Entry';
const content = 'Test dual memory write';

await writer.dualWrite(agentType, { title, content, type: 'test' });</code></pre>
</code></pre>
<p>This will write the provided memory entry to the persistent memory store, the agent-specific memory file, and the extended context file.</p>
<h2 id="configuration">Configuration</h2>
<p>This script does not have any configuration options or environment variables. The file paths for the persistent memory store, agent-specific memory files, and extended context file are hardcoded in the <code>DualMemoryWriter</code> class.</p>
<h2 id="error-handling">Error Handling</h2>
<p>The script uses try-catch blocks to handle errors that may occur during the file reading and writing operations. If an error occurs, the corresponding error message is logged to the console, and the relevant write operation is considered a failure.</p>
<h2 id="integration">Integration</h2>
<p>The <code>dual-memory-writer.js</code> script is designed to be integrated into a larger system that uses agent-based memory management. It can be used to ensure that all agent memory updates are consistently recorded in multiple locations, improving data redundancy and reliability.</p>
<h2 id="development-notes">Development Notes</h2>
<ul>
<li>The <code>sanitizeForJSON</code> method is crucial to prevent JSON parsing errors that may occur due to special characters or control characters in the input data.</li>
<li>The script uses the <code>path</code> module to construct file paths in a platform-independent manner.</li>
<li>The <code>dualWrite</code> method considers the overall operation a success if at least 2 out of 3 write operations are successful. This provides a degree of fault tolerance and ensures that the system can continue to function even if one of the write operations fails.</li>
<li>The script includes a placeholder for integrating with an MCP (Master Control Plane) memory store, which can be implemented if needed.</li>
</ul>

        </main>

        <footer class="footer">
            <p>Generated from <strong>dual-memory-writer.md</strong> ‚Ä¢ StackTrackr Documentation System ‚Ä¢ Last updated: 2025-08-20</p>
        </footer>
    </div>
</body>
</html>