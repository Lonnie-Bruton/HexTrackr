# document-sweep.js - Combined Documentation

> **Note**: This file was too large for single analysis and was processed in 2 chunks.
> Successfully processed: 2/2 chunks.

## File Overview

This documentation was generated by analyzing the file in chunks due to size limitations.

## Chunk 1 Analysis

# Document Sweep - Batch Documentation Generator using AI APIs

## Purpose & Overview

The `document-sweep.js` script is a powerful tool that automates the generation of comprehensive documentation for all JavaScript files within a specified set of directories. It utilizes the AI-powered `document-generator.js` (which supports Groq and Gem APIs) to create detailed documentation for each file.

The primary goals of this script are to:

1. **Streamline Documentation Creation**: By automating the documentation generation process, this script saves time and ensures consistency across the project's codebase.
2. **Maintain Accurate Documentation**: The script tracks changes in the documentation and generates diffs, allowing for easy identification and tracking of updates.
3. **Facilitate Developer Onboarding**: The generated documentation provides clear, comprehensive information to help new developers quickly understand the project's code and architecture.

## Technical Architecture

The `DocumentSweep` class is the core of this script, and it performs the following key tasks:

1. **File Discovery**: The `findJavaScriptFiles()` method scans the specified target directories and identifies all JavaScript files, excluding those that match the configured exclusion patterns.
2. **Documentation Generation**: The `generateDocumentation()` method uses the `document-generator.js` script to generate documentation for each JavaScript file. It checks for existing documentation and generates diffs if an update is detected.
3. **Diff Generation and Tracking**: The `generateAndSaveDiff()` method creates a git-format diff for updated documentation files and logs the changes in a change log file.
4. **HTML Documentation Generation**: The `generateHtmlDocumentation()` method converts select Markdown files (e.g., roadmaps) to HTML format using the `HTMLDocGenerator` class.
5. **Multi-Format Summary**: The `generateMultiFormatSummary()` method creates a detailed summary of the documentation sweep in Markdown, JSON, and HTML formats.

The script also includes various utility methods, such as `scanDirectory()` and `generateGitDiff()`, to support the main functionality.

## Dependencies

The `document-sweep.js` script relies on the following external dependencies:

- `fs-extra`: A comprehensive file system library for Node.js, providing enhanced functionality over the built-in `fs` module.
- `path`: The built-in Node.js module for handling file paths.
- `child_process`: The built-in Node.js module for spawning child processes.
- `url`: The built-in Node.js module for URL resolution and parsing.
- `crypto`: The built-in Node.js module for cryptographic functionality.
- `./html-doc-generator.js`: A custom module that generates HTML documentation from Markdown files.

## Key Functions/Classes

### `DocumentSweep` Class

The `DocumentSweep` class is the main entry point for the script and handles the entire documentation generation process.

**Constructor**:

- Initializes the base directory, paths to the document generator and HTML generator, target directories, roadmap files, and exclusion patterns.
- Sets up the results object to track the progress and outcomes of the documentation sweep.

**`findJavaScriptFiles()`**:

- Recursively scans the target directories to find all JavaScript files, excluding those that match the configured exclusion patterns.
- Returns an array of file paths.

**`generateDocumentation(filePath)`**:

- Generates documentation for the specified JavaScript file using the `document-generator.js` script.
- Checks if the documentation already exists and generates a diff if an update is detected.
- Updates the results object with the success/failure status and any errors.

**`generateAndSaveDiff(sourceFilePath, docPath, previousContent)`**:

- Generates a git-format diff between the previous and new documentation content.
- Saves the diff to a file in the `logs/documentation-diffs` directory.
- Logs the change details in the `logs/documentation-changes.log` file.

**`generateGitDiff(filePath, oldContent, newContent)`**:

- Generates a git-format diff between the old and new content.
- Includes a unified diff header and the line-by-line changes.

**`generateHtmlDocumentation()`**:

- Generates HTML documentation for the specified roadmap Markdown files using the `HTMLDocGenerator` class.
- Updates the results object with the success/failure status and any errors.

**`generateMultiFormatSummary()`**:

- Generates a detailed summary of the documentation sweep in Markdown, JSON, and HTML formats.
- Includes information about the processing, success rates, changes, diffs, and errors.

**`performSweep()`**:

- Orchestrates the entire documentation sweep process, including file discovery, documentation generation, HTML generation, and multi-format summary creation.
- Prints a final summary of the results.

### `HTMLDocGenerator` Class

The `HTMLDocGenerator` class is responsible for converting Markdown files to HTML format. It uses the `marked` library for Markdown parsing and the `highlight.js` library for syntax highlighting.

**`generateHtml(markdownPath)`**:

- Reads the Markdown content from the specified file.
- Converts the Markdown to HTML using the `marked` library.
- Adds syntax highlighting to the code blocks using the `highlight.js` library.
- Writes the resulting HTML content to a file in the `html-docs` directory.

## Usage Examples

To run the `document-sweep.js` script, follow these steps:

1. Ensure that you have Node.js and npm installed on your system.
2. Clone the repository containing the `document-sweep.js` script and the `document-generator.js` script.
3. Install the required dependencies by running `npm install` in the project directory.
4. Customize the `DocumentSweep` class constructor to specify the appropriate base directory, target directories, and any other configurations.
5. Run the script using the command `node document-sweep.js`.

The script will automatically generate documentation for all JavaScript files in the specified directories and create a multi-format summary in the `logs` directory.

## Configuration

The `DocumentSweep` class has several configuration options that can be adjusted:

- `baseDir`: The base directory where the project files are located.
- `documentGenerator`: The path to the `document-generator.js` script.
- `htmlGenerator`: An instance of the `HTMLDocGenerator` class for generating HTML documentation.
- `targetDirectories`: An array of directories to scan for JavaScript files.
- `roadmapFiles`: An array of Markdown files to be converted to HTML documentation.
- `excludePatterns`: An array of directory and file patterns to exclude from the documentation sweep.

These configuration options can be modified in the `DocumentSweep` constructor to suit the specific needs of the project.

## Error Handling

The `DocumentSweep` class handles errors in the following ways:

1. If an error occurs while scanning a directory, it logs the error message and continues processing the remaining files.
2. If an error occurs during the documentation generation for a file, it logs the error message, updates the results object, and continues with the next file.
3. If an error occurs during the HTML documentation generation, it logs the error message, updates the results object, and continues with the next file.

All errors are logged in the `results.errors` array, which is included in the final multi-format summary.

## Integration

The `document-sweep.js` script is designed to be a standalone utility that can be integrated into a larger project or development workflow. It can be used as part of a continuous integration/continuous deployment (CI/CD) pipeline to automatically generate and update the project's documentation.

## Development Notes

- The script uses a simple line-by-line diff algorithm to generate git-format diffs. This could be enhanced with a more sophisticated diff algorithm for better accuracy.
- The script currently uses a hard-coded timeout of 30 seconds per file for the documentation generation. This may need to be adjusted based on the complexity of the project's codebase and the performance of the AI-powered documentation generator.
- The script could be further extended to support additional output formats, integration with version control systems, or automatic deployment of the generated documentation.

---

## Chunk 2 Analysis

# Document Sweep Summary

## Purpose & Overview (2)

The `document-sweep.js` script is responsible for generating comprehensive documentation for a codebase. It scans the project directory, identifies JavaScript files, and generates Markdown, JSON, and HTML summaries of the changes and errors detected during the documentation generation process. The script is designed to be run as a part of a continuous integration (CI) or automation workflow to ensure that the project's documentation is up-to-date and accessible in multiple formats.

## Technical Architecture (2)

The `DocumentSweep` class is the main entry point for the script. It has the following key components:

1. **File Discovery**: The `findJavaScriptFiles()` method is responsible for locating all JavaScript files in the project directory.
2. **Markdown Summary Generation**: The `generateMarkdownSummary()` method generates a detailed Markdown summary of the documentation generation process, including the overall execution summary, changes detected, and any errors encountered.
3. **HTML Generation**: The `HTMLGenerator` class (not shown in the provided code) is responsible for generating HTML documentation from the source files.
4. **Logging and Reporting**: The `printSummary()` method logs the overall results of the documentation sweep to the console, and also saves a detailed JSON report to the `logs/` directory.
5. **Auto-Sync**: The `startAutoSync()` method sets up a file watcher using the `chokidar` library to automatically regenerate the HTML documentation when changes are detected in the "roadmap" files.

The script uses several external dependencies, including `fs-extra` for file system operations and `chokidar` for the auto-sync functionality.

## Dependencies (2)

The script has the following external dependencies:

- `fs-extra`: For advanced file system operations
- `chokidar`: For file change monitoring and auto-sync functionality

## Key Functions/Classes (2)

### `DocumentSweep` Class (2)

The `DocumentSweep` class is the main entry point for the script and has the following key methods:

1. **`performSweep()`**: Performs the main documentation generation process, including file discovery, HTML generation, and summary reporting.
2. **`generateMarkdownSummary(data)`**: Generates a detailed Markdown summary of the documentation generation process, based on the provided `data` object.
3. **`printSummary()`**: Logs the overall results of the documentation sweep to the console and saves a detailed JSON report to the `logs/` directory.
4. **`startAutoSync()`**: Sets up a file watcher to automatically regenerate the HTML documentation when changes are detected in the "roadmap" files.
5. **`dryRun()`**: Previews the files that would be processed without actually generating the documentation.

### `HTMLGenerator` Class (Not Shown)

The `HTMLGenerator` class is responsible for generating HTML documentation from the source files. It is not shown in the provided code, but it likely has methods for parsing the source files, generating the HTML content, and saving the output files.

## Usage Examples (2)

1. **Perform a full documentation sweep**:

   ```bash
   node document-sweep.js
   ```

1. **Run a dry run to preview the files that would be processed**:

   ```bash
   node document-sweep.js --dry-run
   ```

1. **Start the auto-sync mode to watch for changes in the roadmap files**:

   ```bash
   node document-sweep.js --auto-sync
   ```

## Configuration (2)

The script does not have any explicit configuration options or environment variables. However, the paths and file names for the "roadmap" files are hardcoded in the `startAutoSync()` method:

```javascript
const roadmapFiles = [
    'MASTER_ROADMAP.md',
    'TASK_SUMMARY.md', 
    'RSCRIBE_DOCUMENT_PROTOCOL.md'
].map(file => path.join(this.baseDir, file));
```

You may need to update these paths and file names to match your project's structure.

## Error Handling (2)

The script handles errors in the following ways:

1. **HTML Generation Errors**: If there is an error during the HTML generation process, the script logs the error message to the console using `console.error()`.
2. **General Errors**: If an error occurs during the main `performSweep()` or `startAutoSync()` methods, the script logs the error message to the console using `console.error()` and then exits the process with a non-zero exit code.

## Integration (2)

The `document-sweep.js` script is designed to be integrated into a larger system or workflow, such as a continuous integration (CI) pipeline. It can be used to automatically generate and update the project's documentation as part of the build process, ensuring that the documentation remains up-to-date and accessible in multiple formats (Markdown, JSON, and HTML).

## Development Notes (2)

1. **Dependency Management**: The script uses the `chokidar` library for file change monitoring and auto-sync functionality. This library is not a standard Node.js module and may need to be installed separately.
2. **Path Handling**: The script uses the `path` module to handle file and directory paths in a cross-platform manner.
3. **Logging and Reporting**: The script generates detailed logs and reports, which can be useful for troubleshooting and monitoring the documentation generation process.
4. **Extensibility**: The script is designed to be extensible, with the ability to add new features or customize the documentation generation process as needed.

---

## Processing Summary

- **Total Chunks**: 2
- **Successful**: 2
- **Failed**: 0
- **Processing Method**: Smart chunking with rate limiting
- **Generated**: 2025-08-20T00:48:51.748Z
