<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filters Module Documentation - StackTrackr Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .header .meta {
            font-size: 0.9em;
            opacity: 0.7;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 8px 16px;
            background: #007acc;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
            max-width: none;
        }

        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .content h1 { font-size: 2.2em; border-bottom: 3px solid #007acc; padding-bottom: 10px; }
        .content h2 { font-size: 1.8em; color: #007acc; }
        .content h3 { font-size: 1.4em; color: #495057; }
        .content h4 { font-size: 1.2em; color: #6c757d; }

        .content p {
            margin-bottom: 16px;
            line-height: 1.7;
            color: #444;
        }

        .content ul, .content ol {
            margin-bottom: 16px;
            padding-left: 25px;
        }

        .content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .content blockquote {
            border-left: 4px solid #007acc;
            background: #f8f9fa;
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 0 6px 6px 0;
        }

        .content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        .content pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .content pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .content th, .content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e1e4e8;
        }

        .content th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .content tr:hover {
            background: #f8f9fa;
        }

        .content a {
            color: #007acc;
            text-decoration: none;
            font-weight: 500;
        }

        .content a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-top: 1px solid #e1e4e8;
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
        }

        .doc-meta {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007acc;
        }

        .doc-meta h3 {
            color: #007acc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }

        .meta-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        .meta-value {
            color: #6c757d;
            font-size: 0.9em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .content { padding: 20px; }
            .header { padding: 20px; }
            .nav-bar { padding: 15px 20px; }
            .nav-links { justify-content: center; }
            .header .meta { flex-direction: column; gap: 10px; }
        }

        /* Category-specific colors */
        .color-vision { --primary: #9c27b0; --secondary: #7b1fa2; }
        .color-roadmap { --primary: #007acc; --secondary: #0056b3; }
        .color-engine { --primary: #2c3e50; --secondary: #34495e; }
        .color-agent { --primary: #28a745; --secondary: #198754; }
        .color-brain { --primary: #6f42c1; --secondary: #495057; }
        .color-docker { --primary: #0db7ed; --secondary: #086dd7; }
        .color-mobile { --primary: #fd7e14; --secondary: #dc3545; }
        .color-protocol { --primary: #20c997; --secondary: #198754; }
        .color-scribe { --primary: #17a2b8; --secondary: #138496; }
        .color-groq { --primary: #ffc107; --secondary: #e0a800; }
        .color-task { --primary: #dc3545; --secondary: #c82333; }
        .color-cleanup { --primary: #6c757d; --secondary: #5a6268; }
        .color-quickstart { --primary: #28a745; --secondary: #198754; }
        .color-patch { --primary: #ff6b35; --secondary: #e55a32; }
        .color-rengine { --primary: #8b5cf6; --secondary: #7c3aed; }
        .color-default { --primary: #495057; --secondary: #6c757d; }
    </style>
</head>
<body class="color-default">
    <div class="container">
        <header class="header">
            <div class="header-icon">üìÑ</div>
            <h1>Filters Module Documentation</h1>
            <div class="subtitle">Documentation</div>
            <div class="meta">
                <span>üìÅ filters.md</span>
                <span>üìÖ 2025-08-18</span>
                <span>üìä 5KB</span>
            </div>
        </header>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="../index.html" class="nav-link">üè† Documentation Home</a>
                <a href="../developmentstatus.html" class="nav-link">üìä Development Status</a>
                <a href="../generated/js/filters.md" class="nav-link">üìù View Source MD</a>
                <a href="../json/filters.json" class="nav-link">üîß JSON Data</a>
            </div>
        </nav>

        <main class="content">
            <h1 id="filters-module-documentation">Filters Module Documentation</h1>
<h2 id="overview">Overview</h2>
<p>This module provides an advanced filtering system for an inventory management application, likely displayed in a tabular format. It manages active filters, search queries, and interactions with filter UI elements (chips, dropdowns, search input) to dynamically update the displayed inventory. The module includes functions for applying, removing, and clearing filters, simplifying display values for filter chips, generating category summaries, and rendering the active filter chips in the UI.  It also maintains backward compatibility with a legacy column filtering system.</p>
<h2 id="how-to-use">How to Use</h2>
<p>This script is designed to be integrated into a web page and does not run from the command line.  It expects specific HTML elements to be present (e.g., <code>searchInput</code>, <code>typeFilter</code>, <code>metalFilter</code>, <code>activeFilters</code>, <code>chipMinCount</code>) and interacts with global variables like <code>inventory</code>, <code>columnFilters</code>, <code>searchQuery</code>, and <code>currentPage</code>. It also requires color functions like <code>getTypeColor</code>, <code>getPurchaseLocationColor</code>, <code>getStorageLocationColor</code>,  <code>getContrastColor</code>, and other helper functions to handle date formating (<code>formatDisplayDate</code>) and to get metal details from the <code>composition</code> field (<code>getCompositionFirstWords</code>). Finally, it requires color definitions provided via <code>METAL_COLORS</code> and <code>METAL_TEXT_COLORS</code>. Please refer to the code and the broader application&#39;s documentation for details on integrating this module into your web page.</p>
<h2 id="core-logic-breakdown">Core Logic Breakdown</h2>
<p>This module centers around managing the <code>activeFilters</code> object, which stores the current filter criteria. Key functions include:</p>
<ul>
<li><p><strong><code>clearAllFilters()</code></strong>: Resets <code>activeFilters</code>, <code>columnFilters</code>, and <code>searchQuery</code> to their initial states. Clears corresponding input fields and resets pagination.  Rerenders the table and filter chips.</p>
</li>
<li><p><strong><code>removeFilter(field, value)</code></strong>: Removes a specific filter based on the provided <code>field</code> and <code>value</code>.  Handles clearing the search query if <code>field</code> is &#39;search&#39;. Updates the UI and rerenders the table.</p>
</li>
<li><p><strong><code>simplifyChipValue(value, field)</code></strong>: Simplifies long coin names for display in filter chips. Handles comma-separated values and provides a lookup table for common abbreviations.</p>
</li>
<li><p><strong><code>generateCategorySummary(inventory)</code></strong>: Analyzes the filtered inventory to provide counts for metals, types, dates, purchase locations, and storage locations. Respects a minimum count threshold (configurable via UI or localStorage) for displaying category chips.</p>
</li>
<li><p><strong><code>hasMatchingData(field, value, inventory)</code></strong>: Checks if a specific filter criteria has any matches within the provided inventory. Used for optimizing the rendering of filter chips.</p>
</li>
<li><p><strong><code>renderActiveFilters()</code></strong>: Renders the filter chips in the UI based on the current <code>activeFilters</code>, <code>columnFilters</code> and generated category summaries.  Provides visual feedback of active filters and allows users to remove them.</p>
</li>
<li><p><strong><code>filterInventoryAdvanced()</code></strong>: The core filtering logic.  Applies the <code>activeFilters</code>, legacy <code>columnFilters</code>, and <code>searchQuery</code> to the <code>inventory</code> array. Includes handling for exclusion filters, date ranges, and complex search queries (comma-separated values, multi-word searches with appropriate handling for fractional coin weights and avoiding broad cross-metal matches).</p>
</li>
<li><p><strong><code>applyQuickFilter(field, value, isGrouped)</code></strong>: Applies a filter based on clicking a value in the table. Supports toggling filters (clicking the same value removes the filter) and stacking multiple filters.  Handles grouped name filtering.</p>
</li>
<li><p><strong><code>applyColumnFilter(field, value)</code></strong>: Legacy function for backward compatibility, simply calls <code>applyQuickFilter</code>.</p>
</li>
</ul>
<h2 id="configuration--dependencies">Configuration &amp; Dependencies</h2>
<p>This module has no external dependencies (npm packages). However, it relies on:</p>
<ul>
<li><strong>Global Variables</strong>: <code>inventory</code>, <code>columnFilters</code>, <code>searchQuery</code>, <code>currentPage</code>, <code>PREBUILT_LOOKUP_DATA</code>, <code>METAL_COLORS</code>, <code>METAL_TEXT_COLORS</code></li>
<li><strong>HTML Elements</strong>: <code>searchInput</code>, <code>typeFilter</code>, <code>metalFilter</code>, <code>activeFilters</code>, <code>chipMinCount</code></li>
<li><strong>Helper Functions</strong>: <code>getTypeColor</code>, <code>getPurchaseLocationColor</code>, <code>getStorageLocationColor</code>, <code>getContrastColor</code>, <code>formatDisplayDate</code>, <code>getCompositionFirstWords</code></li>
<li><strong>Optional Feature Flags</strong>: <code>window.featureFlags</code> and <code>window.autocomplete</code> for grouped name filtering</li>
<li><strong>Local Storage</strong>: <code>chipMinCount</code> for persisting the minimum count setting.</li>
</ul>
<h2 id="machine-readable-summary">Machine-Readable Summary</h2>
<pre><code class="language-json"><pre><code class="language-json">{
  "scriptName": "filters.js",
  "purpose": "Provides an advanced filtering and search system for an inventory management application. Manages active filters, search queries, and updates the displayed inventory based on user interactions.",
  "inputs": {
    "arguments": [],
    "dependencies": {
      "globalVariables": ["inventory", "columnFilters", "searchQuery", "currentPage", "PREBUILT_LOOKUP_DATA", "METAL_COLORS", "METAL_TEXT_COLORS"],
      "htmlElements": ["searchInput", "typeFilter", "metalFilter", "activeFilters", "chipMinCount"],
      "helperFunctions": ["getTypeColor", "getPurchaseLocationColor", "getStorageLocationColor", "getContrastColor", "formatDisplayDate", "getCompositionFirstWords"],
      "featureFlags": ["window.featureFlags", "window.autocomplete"],
      "localStorage": ["chipMinCount"]
    }
  },
  "outputs": {
    "uiUpdates": ["Filter chips", "Table data"],
    "modifiedGlobalVariables": ["activeFilters", "columnFilters", "searchQuery", "currentPage"]
  }
}
</code></pre>
</code></pre>

        </main>

        <footer class="footer">
            <p>Generated from <strong>filters.md</strong> ‚Ä¢ StackTrackr Documentation System ‚Ä¢ Last updated: 2025-08-18</p>
        </footer>
    </div>
</body>
</html>