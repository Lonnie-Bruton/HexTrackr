<!-- Section Template for Documentation Portal -->
<div class="documentation-section">
    <h1>🔄 UI-API Interaction Flowcharts</h1>
<p>Complete documentation of data flow patterns between HexTrackr&#39;s frontend JavaScript and backend APIs.</p>
<p><strong>Architecture:</strong> Dual-pattern system with localStorage-based tickets and API-based vulnerabilities<br><strong>Frontend:</strong> Modular JavaScript in <code>scripts/pages/</code><br><strong>Backend:</strong> Node.js/Express with SQLite database<br><strong>Migration:</strong> Tickets transitioning from localStorage to API pattern</p>
<h2>🏗️ Architecture Overview</h2>
<h3>Frontend Layer</h3>
<ul>
<li><strong>tickets.html</strong> - localStorage + Migration</li>
<li><strong>vulnerabilities.html</strong> - API-based</li>
</ul>
<h3>Backend Layer</h3>
<ul>
<li><strong>server.js</strong> - Express API</li>
<li><strong>SQLite</strong> - data/hextrackr.db</li>
</ul>
<h2>🎫 Tickets Data Flow (localStorage → Database Migration)</h2>
<h3>Frontend: scripts/pages/tickets.js</h3>
<ul>
<li><code>loadTicketsFromDB()</code> → <code>GET /api/tickets</code></li>
<li><code>saveTicket()</code> → <code>POST /api/tickets</code></li>
<li><code>updateTicket()</code> → <code>PUT /api/tickets/:id</code></li>
<li><code>deleteTicket()</code> → <code>DELETE /api/tickets/:id</code></li>
<li><code>migrateFromLocalStorageIfNeeded()</code> → <code>POST /api/tickets/migrate</code></li>
</ul>
<h3>Backend: server.js API Endpoints</h3>
<ul>
<li><code>GET /api/tickets</code> - Retrieve all tickets with filtering</li>
<li><code>POST /api/tickets</code> - Create new ticket</li>
<li><code>PUT /api/tickets/:id</code> - Update existing ticket</li>
<li><code>DELETE /api/tickets/:id</code> - Remove ticket</li>
<li><code>GET /api/sites</code> - Get location/site data</li>
<li><code>GET /api/locations</code> - Get location options</li>
<li><code>POST /api/tickets/migrate</code> - Migrate localStorage to database</li>
</ul>
<h2>🛡️ Vulnerabilities Data Flow (Full API Integration)</h2>
<h3>Frontend: vulnerabilities.html (Embedded JS)</h3>
<ul>
<li><code>importCSV()</code> → <code>POST /api/vulnerabilities/import</code></li>
<li><code>loadVulnerabilities()</code> → <code>GET /api/vulnerabilities</code></li>
<li><code>loadTrends()</code> → <code>GET /api/vulnerabilities/trends</code></li>
<li><code>getVulnerabilityStats()</code> → <code>GET /api/vulnerabilities/stats</code></li>
<li><code>clearAllData()</code> → <code>DELETE /api/vulnerabilities/clear</code></li>
<li><code>getImportHistory()</code> → <code>GET /api/imports</code></li>
<li><code>fetchTenableHistoricalData()</code> → <code>GET /api/tenable/historical-vpr</code></li>
</ul>
<h3>Backend: server.js Vulnerability API</h3>
<ul>
<li><code>GET /api/vulnerabilities</code> - List vulnerabilities with pagination &amp; filters</li>
<li><code>POST /api/vulnerabilities/import</code> - CSV upload with UPSERT logic</li>
<li><code>GET /api/vulnerabilities/stats</code> - Dashboard statistics</li>
<li><code>GET /api/vulnerabilities/trends</code> - Time-series trend data</li>
<li><code>DELETE /api/vulnerabilities/clear</code> - Clear all vulnerability data</li>
<li><code>GET /api/imports</code> - Import history with metadata</li>
<li><code>GET /api/tenable/historical-vpr</code> - Fetch Tenable historical VPR data</li>
</ul>
<h2>📋 Complete Server.js API Reference</h2>
<div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">[object Object]</thead>
                    <tbody>undefined</tbody>
                </table>
            </div><h2>🔄 Current Data Flow Patterns</h2>
<h3>📦 Tickets: localStorage → Database Migration</h3>
<ol>
<li>Check for localStorage data</li>
<li>Migrate to database if found  </li>
<li>Use API for all new operations</li>
<li>Clear localStorage after migration</li>
</ol>
<p><strong>Status:</strong> Transition complete - now API-based</p>
<h3>🛡️ Vulnerabilities: Full API Integration</h3>
<ol>
<li>CSV upload via multipart/form-data</li>
<li>Server processing with UPSERT logic</li>
<li>Time-series data storage</li>
<li>Real-time dashboard updates</li>
</ol>
<p><strong>Status:</strong> Complete API-based architecture</p>
<h2>🚀 Future Architecture Considerations</h2>
<h3>Authentication Integration</h3>
<p>Add JWT token authentication to all API endpoints for secure multi-user access.</p>
<h3>Real-time Updates</h3>
<p>Implement WebSocket connections for live data updates across multiple browser sessions.</p>
<h3>API Versioning</h3>
<p>Version API endpoints (e.g., <code>/api/v1/</code>) to support backward compatibility during updates.</p>
<h3>Ticket-Vulnerability Cross-Reference</h3>
<p>Implement API endpoints for the <code>ticket_vulnerabilities</code> junction table.</p>

</div>

<!-- Section-specific styling can be added here -->
<style>
    
</style>
