<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HexTrackr - Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/css/tabler.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="../../styles/shared/base.css" rel="stylesheet">
    <link href="../../styles/shared/header.css" rel="stylesheet">
    <link href="../css/docs-tabler.css" rel="stylesheet">
</head>
<body>
    <div class="page">
        <!-- Shared Header -->
        <div id="headerContainer"></div>
        
        <div class="page-wrapper">
            <div class="page-body">
                <div class="container-xl">
                    <div class="row g-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h1>Docker Deployment Guide</h1>
<p>This document explains how to build, configure, and deploy the HexTrackr application using Docker and Docker Compose. The application is designed to run in a containerized environment, ensuring consistency across different setups.</p>
<h2>Prerequisites</h2>
<ul>
<li><strong>Docker</strong>: Ensure Docker is installed and running on your system. You can download it from the <a href="httpss://www.docker.com/products/docker-desktop">official Docker website</a>.</li>
<li><strong>Docker Compose</strong>: Docker Compose is included with modern Docker Desktop installations.</li>
</ul>
<h2>Key Configuration Files</h2>
<ul>
<li><strong><code>docker-compose.yml</code></strong>: This is the main orchestration file for defining and running the multi-container Docker application. It defines the <code>hextrackr</code> service, its build context, port mappings, and volume mounts.</li>
<li><strong><code>Dockerfile.node</code></strong>: This file contains the instructions for building the Docker image for the Node.js backend service. It specifies the base image, sets up the working directory, installs dependencies, and defines the startup command.</li>
</ul>
<hr>
<h2>Building the Docker Image</h2>
<p>The Docker image is built automatically when you run <code>docker-compose up</code>. However, you can also build it manually if needed.</p>
<p>To build the image directly, run the following command from the project root:</p>
<pre><code class="language-bash">docker build -f Dockerfile.node -t hextrackr-app .
</code></pre>
<h2>Running the Application</h2>
<p>The recommended way to run the application is by using Docker Compose, which handles the service definition, networking, and volume mounts automatically.</p>
<h3>1. Start the Application</h3>
<p>To start the application in detached mode (running in the background), execute the following command from the project root directory:</p>
<pre><code class="language-bash">docker-compose up -d
</code></pre>
<h3>2. Verify the Application is Running</h3>
<p>You can check the status of the running containers with:</p>
<pre><code class="language-bash">docker-compose ps
</code></pre>
<p>You should see the <code>hextrackr</code> service listed with a status of <code>Up</code>.</p>
<h3>3. Accessing the Application</h3>
<p>Once the container is running, you can access the HexTrackr application in your web browser at:</p>
<ul>
<li><strong>URL</strong>: <code>http://localhost:8080</code></li>
</ul>
<p>The default page is the <strong>Tickets</strong> interface.</p>
<hr>
<h2>Docker Configuration Details</h2>
<h3><code>docker-compose.yml</code></h3>
<p>The <code>docker-compose.yml</code> file defines the <code>hextrackr</code> service with the following key configurations:</p>
<ul>
<li><strong><code>build</code></strong>:<ul>
<li><code>context: .</code>: The build context is the current directory.</li>
<li><code>dockerfile: Dockerfile.node</code>: Specifies the Dockerfile to use for building the image.</li>
</ul>
</li>
<li><strong><code>ports</code></strong>:<ul>
<li><code>&quot;8080:8080&quot;</code>: Maps port <code>8080</code> on the host machine to port <code>8080</code> in the container, making the application accessible from the host.</li>
</ul>
</li>
<li><strong><code>volumes</code></strong>:<ul>
<li><code>./:/app</code>: Mounts the entire project directory into the <code>/app</code> directory inside the container. This is useful for development, as changes to the source code are immediately reflected in the container.</li>
<li><code>/app/node_modules</code>: An anonymous volume is used for <code>node_modules</code> to prevent the host&#39;s <code>node_modules</code> directory (if it exists) from overwriting the one installed inside the container.</li>
<li><code>./data:/app/data</code>: Mounts the <code>data</code> directory, ensuring that the SQLite database (<code>hextrackr.db</code>) persists even if the container is removed and recreated.</li>
</ul>
</li>
<li><strong><code>environment</code></strong>:<ul>
<li><code>NODE_ENV=development</code>: Sets the Node.js environment to development mode.</li>
</ul>
</li>
<li><strong><code>restart: unless-stopped</code></strong>: Ensures the container will restart automatically unless it is explicitly stopped.</li>
</ul>
<h3><code>Dockerfile.node</code></h3>
<p>The <code>Dockerfile.node</code> contains the steps to create a production-ready image for the application:</p>
<ul>
<li><strong><code>FROM node:18-alpine</code></strong>: Uses a lightweight, official Node.js 18 base image.</li>
<li><strong><code>WORKDIR /app</code></strong>: Sets the working directory inside the container to <code>/app</code>.</li>
<li><strong>Dependency Installation</strong>:<ul>
<li>It first copies <code>package.json</code> and <code>package-lock.json</code> and runs <code>npm install</code>. This leverages Docker&#39;s layer caching, so dependencies are only re-installed if these files change.</li>
<li>It installs <code>python3</code>, <code>make</code>, and <code>g++</code> which are required for rebuilding native Node.js modules (like <code>sqlite3</code>).</li>
</ul>
</li>
<li><strong>Copying Application Files</strong>: Copies all necessary source code, scripts, and configuration files into the working directory.</li>
<li><strong>Directory Creation</strong>: Creates essential directories like <code>data</code>, <code>uploads</code>, and <code>docs</code> within the container.</li>
<li><strong><code>EXPOSE 8080</code></strong>: Informs Docker that the container listens on port <code>8080</code>.</li>
<li><strong><code>CMD [&quot;node&quot;, &quot;server.js&quot;]</code></strong>: Defines the default command to run when the container starts, which launches the Express server.</li>
</ul>
<hr>
<h2>Stopping the Application</h2>
<p>To stop the running application, use the following command:</p>
<pre><code class="language-bash">docker-compose down
</code></pre>
<p>This command stops and removes the containers defined in the <code>docker-compose.yml</code> file. Because the database is in a mounted volume, your data will be preserved.</p>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Shared Footer -->
    <div id="footerContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/js/tabler.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <!-- Load shared header and footer -->
    <script src="../../scripts/shared/header-loader.js"></script>
    <script src="../../scripts/shared/footer-loader.js"></script>
</body>
</html>
